<!doctype html><html><head><title>C++课程设计：3.2-所有项目</title><base href="./"><meta id="root-path" root-path="./"><link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5"><meta charset="UTF-8"><link rel="stylesheet" href="lib/styles/obsidian-styles.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="stylesheet" href="lib/styles/plugin-styles.css"><link rel="stylesheet" href="lib/styles/snippets.css"><link rel="stylesheet" href="lib/styles/generated-styles.css"><style></style><script type="module" src="lib/scripts/graph_view.js"></script><script src="lib/scripts/graph_wasm.js"></script><script src="lib/scripts/tinycolor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lib/scripts/webpage.js"></script><script src="lib/scripts/generated.js"></script></head><body class="theme-dark mod-macos native-scrollbars show-inline-title loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">C++课程设计</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">代码</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="代码/`.env`.html"><span class="tree-item-title">`.env`</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="代码/`.gitignore`.html"><span class="tree-item-title">`.gitignore`</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="代码/`minifest.in`.html"><span class="tree-item-title">`MINIFEST.in`</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="代码/app.py.html"><span class="tree-item-title">app.py</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="代码/base.html.html"><span class="tree-item-title">base.html</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">技术栈</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/编码.html"><span class="tree-item-title">编码</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/博客.html"><span class="tree-item-title">博客</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/命令行程序设计.html"><span class="tree-item-title">命令行程序设计</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/软件开发日志怎么写？.html"><span class="tree-item-title">软件开发日志怎么写？</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/知识产权.html"><span class="tree-item-title">知识产权</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/css.html"><span class="tree-item-title">CSS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/dom.html"><span class="tree-item-title">DOM</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/flask.html"><span class="tree-item-title">Flask</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/git.html"><span class="tree-item-title">Git</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/html.html"><span class="tree-item-title">HTML</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/javascript.html"><span class="tree-item-title">JavaScript</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/jsonify.html"><span class="tree-item-title">jsonify</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/markdown.html"><span class="tree-item-title">MarkDown</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/mvc.html"><span class="tree-item-title">MVC</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/python.html"><span class="tree-item-title">Python</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/request.html"><span class="tree-item-title">request</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/sql.html"><span class="tree-item-title">SQL</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/sqlite.html"><span class="tree-item-title">SQLite</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/sqlite3.html"><span class="tree-item-title">sqlite3</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/typescript.html"><span class="tree-item-title">typescript</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术栈/yaml.html"><span class="tree-item-title">yaml</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">C++课程设计：产品文档</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">其他材料</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：产品文档/其他材料/更新日志.html"><span class="tree-item-title">更新日志</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">用户指南</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：产品文档/用户指南/快速上手.html"><span class="tree-item-title">快速上手</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：产品文档/用户指南/前言.html"><span class="tree-item-title">前言</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：产品文档/c++课程设计：产品文档.html"><span class="tree-item-title">C++课程设计：产品文档</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计.html"><span class="tree-item-title">C++课程设计</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：1-选题_atimer.html"><span class="tree-item-title">C++课程设计：1-选题_ATimer</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：2-设计程序.html"><span class="tree-item-title">C++课程设计：2-设计程序</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：3-最小可用产品.html"><span class="tree-item-title">C++课程设计：3-最小可用产品</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：3.1-注册登录.html"><span class="tree-item-title">C++课程设计：3.1-注册登录</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：3.2-所有项目.html"><span class="tree-item-title">C++课程设计：3.2-所有项目</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：4.项目可安装化.html"><span class="tree-item-title">C++课程设计：4.项目可安装化</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：测试.html"><span class="tree-item-title">C++课程设计：测试</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：代码.html"><span class="tree-item-title">C++课程设计：代码</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：进阶.html"><span class="tree-item-title">C++课程设计：进阶</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：课设要求.html"><span class="tree-item-title">C++课程设计：课设要求</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：目录结构.html"><span class="tree-item-title">C++课程设计：目录结构</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：前端设计.html"><span class="tree-item-title">C++课程设计：前端设计</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：时子延.html"><span class="tree-item-title">C++课程设计：时子延</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：数据库设计.html"><span class="tree-item-title">C++课程设计：数据库设计</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：与王琼老师沟通交流.html"><span class="tree-item-title">C++课程设计：与王琼老师沟通交流</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="c++课程设计：markdown-yaml设计.html"><span class="tree-item-title">C++课程设计：MarkDown-yaml设计</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" tabindex="-1" style="tab-size:4"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section" style="min-height:164px"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header"><div class="inline-title" data-heading="C++课程设计：3.2-所有项目" id="C++课程设计：3.2-所有项目" style="display:block">C++课程设计：3.2-所有项目</div></div><div><p><a data-tooltip-position="top" aria-label="C++课程设计" data-href="C++课程设计" href="c++课程设计.html" class="internal-link" target="_self" rel="noopener">Home</a> <a data-tooltip-position="top" aria-label="C++课程设计：产品文档" data-href="C++课程设计：产品文档" href="c++课程设计：产品文档/c++课程设计：产品文档.html" class="internal-link" target="_self" rel="noopener">Doc</a> <a data-tooltip-position="top" aria-label="更新日志" data-href="更新日志" href="c++课程设计：产品文档/其他材料/更新日志.html" class="internal-link" target="_self" rel="noopener">Changelog</a> <a data-tooltip-position="top" aria-label="https://github.com/AWSzyAI/ATimer/tree/main" rel="noopener" class="external-link" href="https://github.com/AWSzyAI/ATimer/tree/main" target="_blank">Download</a> <a data-tooltip-position="top" aria-label="C++课程设计：时子延" data-href="C++课程设计：时子延" href="c++课程设计：时子延.html" class="internal-link" target="_self" rel="noopener">About</a></p></div><div class="heading-wrapper"><h2 data-heading="需求" class="heading" id="需求"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>需求<div class="heading-after">...</div></h2><div class="heading-children"><div><ul class="contains-task-list"><li data-line="0" data-task="x" class="task-list-item is-checked"><input data-line="0" checked type="checkbox" class="task-list-item-checkbox">设计数据库结构，重构<code>schema.sql</code>与<code>models.py</code> 中的<code>class Project</code></li><li data-line="1" data-task="x" class="task-list-item is-checked"><input data-line="1" checked type="checkbox" class="task-list-item-checkbox">时间数据直接使用Python字典,但实际存储为JSON字符串</li><li data-line="2" data-task="x" class="task-list-item is-checked"><input data-line="2" checked type="checkbox" class="task-list-item-checkbox">实现<code>新建项目(create.html)</code>的POST接口，跳转，数据存储</li><li data-line="3" data-task="" class="task-list-item"><input data-line="3" type="checkbox" class="task-list-item-checkbox">完善<code>所有项目(all.html)</code>的前端<code>html</code>与<code>css</code>设计<ul class="contains-task-list"><li data-line="4" data-task="x" class="task-list-item is-checked"><input data-line="4" checked type="checkbox" class="task-list-item-checkbox">新建项目移动到<code>header</code>右侧</li><li data-line="5" data-task="" class="task-list-item"><input data-line="5" type="checkbox" class="task-list-item-checkbox">设置CSS使得<code>&lt;div class=data&gt;&lt;/div&gt;</code>中的所有<code>&lt;li&gt;&lt;/li&gt;</code>数据排为一行</li></ul></li><li data-line="6" data-task="" class="task-list-item"><input data-line="6" type="checkbox" class="task-list-item-checkbox"><code>record</code>按钮与<code>/create_record</code>路由<ul class="contains-task-list"><li data-line="7" data-task="x" class="task-list-item is-checked"><input data-line="7" checked type="checkbox" class="task-list-item-checkbox"><code>record(inactive) -- stop(active)</code></li><li data-line="8" data-task="" class="task-list-item"><input data-line="8" type="checkbox" class="task-list-item-checkbox">(没有)调用到<code>create_record</code></li><li data-line="9" data-task="" class="task-list-item"><input data-line="9" type="checkbox" class="task-list-item-checkbox">刷新页面</li></ul></li><li data-line="10" data-task="" class="task-list-item"><input data-line="10" type="checkbox" class="task-list-item-checkbox">添加<code>activate</code>属性后的数据库初始化与原始数据的兼容性迁移<ul class="contains-task-list"><li data-line="11" data-task="" class="task-list-item"><input data-line="11" type="checkbox" class="task-list-item-checkbox">从头remake</li><li data-line="12" data-task="" class="task-list-item"><input data-line="12" type="checkbox" class="task-list-item-checkbox"><code>flask db upgrade</code>, <code>flask db init</code> SQL命令</li></ul></li><li data-line="13" data-task="" class="task-list-item"><input data-line="13" type="checkbox" class="task-list-item-checkbox">实现<code>所有项目(all.html)</code>页面的<code>projects</code>数据根据<code>project.all_time</code>所转换的时间长度的值进行降序排列</li><li data-line="14" data-task="" class="task-list-item"><input data-line="14" type="checkbox" class="task-list-item-checkbox"><code>status</code>按照状态分区展示：纵列/横排（看板）<ul><li data-line="15"><code>In Planning</code></li><li data-line="16"><code>In Process</code></li><li data-line="17"><code>Pause</code></li><li data-line="18"><code>Completed</code></li><li data-line="19"><code>Abandon</code></li></ul></li><li data-line="20" data-task="" class="task-list-item"><input data-line="20" type="checkbox" class="task-list-item-checkbox"><code>more</code>按钮与<code>delete</code>，<code>rename</code>,<code>edit(status,note)</code></li><li data-line="21" data-task="" class="task-list-item"><input data-line="21" type="checkbox" class="task-list-item-checkbox">完善<code>profile</code><ul class="contains-task-list"><li data-line="22" data-task="" class="task-list-item"><input data-line="22" type="checkbox" class="task-list-item-checkbox"><code>close_account</code> 注销账号，删除账号密码及其所有相关数据</li><li data-line="23" data-task="" class="task-list-item"><input data-line="23" type="checkbox" class="task-list-item-checkbox"><code>edit</code> 修改账号密码，用户名</li><li data-line="24" data-task="" class="task-list-item"><input data-line="24" type="checkbox" class="task-list-item-checkbox">点击每个模块修改相应数据？？</li></ul></li><li data-line="25" data-task="" class="task-list-item"><input data-line="25" type="checkbox" class="task-list-item-checkbox">课程设计实验报告</li><li data-line="26" data-task="" class="task-list-item"><input data-line="26" type="checkbox" class="task-list-item-checkbox">进阶（后续）<ul class="contains-task-list"><li data-line="27" data-task="" class="task-list-item"><input data-line="27" type="checkbox" class="task-list-item-checkbox">渲染成日历</li><li data-line="28" data-task="" class="task-list-item"><input data-line="28" type="checkbox" class="task-list-item-checkbox">使用邮箱/手机/二维码登录</li></ul></li></ul></div><div><p>传入的start_time,end_time为'2023-09-04 10:05:37.000000', '2023-09-04 10:05:39.000000'，而非'2023-09-04 10:05:37', '2023-09-04 10:05:39'，哪一步出了问题？如何解决？给出具体代码</p></div><div><pre><code>已知
def parse_datetime(datetime_str):
    # 解析日期时间字符串并返回 datetime 对象
    return datetime.strptime(datetime_str, '%Y-%m-%d %H:%M:%S')

record = Record(
    start_time=parse_datetime(start_time),
    end_time=parse_datetime(end_time),
    project_id=project_id
  )
修改
def __init__(self, start_time, end_time, project_id):

&nbsp; &nbsp; self.start_time = start_time &nbsp;# 初始化记录的开始时间

&nbsp; &nbsp; self.end_time = end_time &nbsp;# 初始化记录的结束时间

&nbsp; &nbsp; # 计算并设置记录的时长，timedelta类型转换为字符串

&nbsp; &nbsp; self.duration = str(end_time - start_time)  #str(datetime.timedelta)

&nbsp; &nbsp; self.project_id = project_id &nbsp;# 初始化记录所属项目ID

&nbsp; &nbsp; #self.project.update_time_stats()
中的
self.duration = str(end_time - start_time)  #str(datetime.timedelta)
是duration成为 HH:MM::SS格式的String


···




</code><button class="copy-code-button">复制</button></pre></div><div><pre class="language-html" tabindex="0"><code class="language-html is-loaded"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

  {% for project in projects %}

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-card<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!--项目排名序号--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-rank<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ loop.index }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!--计时按钮，status='Pause'时文本显示为'开始计时'，status='In Process'文本显示为停止计时--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-timer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>timer-btn<span class="token punctuation">"</span></span> <span class="token attr-name">project-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ project.id }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Record<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  

      <span class="token comment">&lt;!--项目名称--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-name<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ project.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!--项目状态--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-status<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ project.status }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!--项目总计时间--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-total-time<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ project.all_time }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!--项目更多按钮--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>project-more<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>more<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>更多<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

  {% endfor %}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>从以上代码可以发现，这里有若干个project组成的模块，每个模块里都有一个<code>id="timer-btn"</code>的按钮，其有一个参数为<code>id="timer-btn"</code>,因project而异。</p></div><div><p>这是project中数据存储的格式 all_time = db.Column(db.String)<br>daily_time = db.Column(JSONEncodedDict, default={})<br>weekly_time = db.Column(JSONEncodedDict, default={})<br>monthly_time = db.Column(JSONEncodedDict, default={})<br>yearly_time = db.Column(JSONEncodedDict, default={})<br>他们都是基于文本的格式，而非时间。<br>当我进行update_time_stats(self,record)时，传入的record中包含的数据有：id = db.Column(db.Integer, primary_key=True,autoincrement=True) &nbsp;# 记录ID，整数类型，主键</p></div><div><p>&nbsp; project_id = db.Column(db.Integer, db.ForeignKey('projects.id'), nullable=False) &nbsp;# 项目ID，整数类型，外键，不能为空</p></div><div><p>&nbsp; start时间 = db.Column(db.DateTime, nullable=False) &nbsp;# 记录开始时间，日期时间类型，不能为空</p></div><div><p>&nbsp; end_time = db.Column(db.DateTime, nullable=False) &nbsp;# 记录结束时间，日期时间类型，不能为空</p></div><div><p>&nbsp; duration = db.Column(db.String, nullable=False, default='00:00:00') &nbsp;# 记录时长，字符串类型，不能为空<br>其中duration为文本类型数据，我需要一个函数来进行对文本存储的时长的计算，提取record中的duration为某一个标准类型，然后update_time_stats(self,record)调用该格式转换函数进行计算日期，更新project的数据参数。update_time_stats(self,record):定义如下，可进行修改，给出所有相关代码：</p></div><div><p>&nbsp; def update_time_stats(self,record):</p></div><div><p>&nbsp; &nbsp; date = record.start_time.date()</p></div><div><p>&nbsp; &nbsp; day = date.strftime("%Y-%m-%d")</p></div><div><p>&nbsp; &nbsp; week = date.strftime("%Y-W%W")</p></div><div><p>&nbsp; &nbsp; month = date.strftime("%Y-%m")</p></div><div><p>&nbsp; &nbsp; year = date.strftime("%Y")</p></div><div><p>&nbsp; &nbsp; if date.isoformat() in self.daily_time:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.daily_time[day] += record.duration</p></div><div><p>&nbsp; &nbsp; else:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.daily_time[day] = record.duration</p></div><div><p>&nbsp; &nbsp; if week in self.weekly_time:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.weekly_time[week] += record.duration</p></div><div><p>&nbsp; &nbsp; else:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.weekly_time[week] = record.duration</p></div><div><p>&nbsp; &nbsp; if month in self.monthly_time:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.monthly_time[month] += record.duration</p></div><div><p>&nbsp; &nbsp; else:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.monthly_time[month] = record.duration</p></div><div><p>&nbsp; &nbsp; if year in self.yearly_time:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.yearly_time[year] += record.duration</p></div><div><p>&nbsp; &nbsp; else:</p></div><div><p>&nbsp; &nbsp; &nbsp; self.yearly_time[year] = record.duration</p></div><div><p>&nbsp; &nbsp; self.calculate_time()</p></div><div><p>&nbsp; &nbsp; db.session.commit()</p></div><div><p>在<code>all.html</code>展示所有项目数据。以若干个卡片列表的形式。每一个卡片从左到右依次有<code>开始计时</code>/<code>停止计时</code>按钮，默认为<code>开始计时</code>,状态为<code>暂停</code>，按下按钮后状态切换为<code>进行中</code>，同时按钮文本切换为<code>停止计时</code>，记录下此时的DateTime作为本次<code>Record</code>的<code>start_time</code>，再次点击按钮（此时钮文本为<code>停止计时</code>），状态从<code>进行中</code>切换为<code>暂停</code>，按钮文本切换回<code>开始计时</code>，记录下此时的DateTime作为本次<code>Record</code>的<code>end_time</code>，完成一次<code>Record</code>,存入数据库中，计算duration=end_time=start_time. 在all_time上+=本次record的duration，在daily_time查询当天日期对应的JSON{date：YYYY-MM-DD,time:HH:MM:SS}，并使得time的值+=duration。若未查询到，则新建一个JSON数据，time默认初始化为0后+=duration。数据实时更新到all.html上，weekly，monthly，yearly以此类推。</p></div><div><p>默认文本显示为<code>record</code>,按钮状态为<code>inactive</code>，按下按钮后状态切换为<code>active</code>，同时按钮文本切换为<code>stop</code>，记录下此时的DateTime作为本次<code>Record</code>的<code>start_time</code>，再次点击按钮（此时钮文本为<code>stop</code>），状态从<code>active</code>切换为<code>inactive</code>，按钮文本切换回<code>record</code>，记录下此时的DateTime作为本次<code>Record</code>的<code>end_time</code>，完成一次<code>record=Record(start_time,end_time)</code>,commit到数据库中，调用<code>project.update_time_stats(record)</code>在all_time上+=本次record的duration，在daily_time查询当天日期对应的JSON{date：YYYY-MM-DD,time:HH:MM:SS}，并使得time的值+=duration。若未查询到，则新建一个JSON数据，time默认初始化为0后+=duration。数据实时更新到all.html上，weekly，monthly，yearly以此类推。</p></div><div><p>编辑按钮的html和路由，给出具体完整的代码</p></div><div><ol><li data-line="0">实现按钮文本随着按钮状态<code>active/inactive</code>的改变而改变</li><li data-line="1"></li></ol></div><div><p><code>stript.js</code> <code>schema.sql</code> <code>models.py</code> <code>views.py</code></p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token comment"># /create  POST </span>

current_user
request<span class="token punctuation">{</span>
	name<span class="token punctuation">,</span>
	status<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

project<span class="token punctuation">(</span>
	<span class="token builtin">id</span> <span class="token operator">=</span> ，<span class="token comment">#生成</span>
	name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	status <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	user_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">###</span>
sqlalchemy<span class="token punctuation">.</span>exc<span class="token punctuation">.</span>StatementError<span class="token punctuation">:</span> <span class="token punctuation">(</span>builtins<span class="token punctuation">.</span>TypeError<span class="token punctuation">)</span> SQLite DateTime <span class="token builtin">type</span> only accepts Python datetime <span class="token keyword">and</span> date objects <span class="token keyword">as</span> <span class="token builtin">input</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>SQL<span class="token punctuation">:</span> INSERT INTO projects <span class="token punctuation">(</span>name<span class="token punctuation">,</span> status<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> all_time<span class="token punctuation">,</span> daily_time<span class="token punctuation">,</span> weekly_time<span class="token punctuation">,</span> monthly_time<span class="token punctuation">,</span> yearly_time<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span>?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>parameters<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'In Planning'</span><span class="token punctuation">,</span> <span class="token string">'user_id'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'monthly_time'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'daily_time'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'yearly_time'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'weekly_time'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  
<span class="token comment">###</span>

<span class="token comment">#创建一条record</span>

record <span class="token operator">=</span> Record<span class="token punctuation">(</span>
  project_id<span class="token operator">=</span>project<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
  start_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#第一次按钮，开始计时</span>
  end_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#第二次按钮，结束计时</span>
<span class="token punctuation">)</span>

record<span class="token punctuation">.</span>duration<span class="token operator">=</span><span class="token number">0</span>
db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>record<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

project<span class="token punctuation">.</span>update_time_stats<span class="token punctuation">(</span>record<span class="token punctuation">)</span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>针对project类，其schema.sql如下：</p></div><div><pre class="language-sql" tabindex="0"><code class="language-sql is-loaded"><span class="token comment">-- 创建 projects 表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> Project <span class="token punctuation">(</span>
  id <span class="token keyword">INTEGER</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  user_id <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  name <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">status</span> <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'In Planning'</span><span class="token punctuation">,</span> <span class="token comment">// 项目状态 InPlanning, InProgress, Completed, Abandoned, Paused</span>
  all_time <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'00:00:00'</span><span class="token punctuation">,</span>
  daily_time JSON<span class="token punctuation">,</span> <span class="token comment">-- 日时间,TEXT类型存储JSON</span>
  weekly_time JSON<span class="token punctuation">,</span>  
  monthly_time JSON<span class="token punctuation">,</span>
  yearly_time JSON<span class="token punctuation">,</span>
  <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">User</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>其中<code>'monthly_time': None, 'daily_time': None, 'yearly_time': None, 'weekly_time': None}</code> 默认为None，非JSON格式。当一个project被创建出来而还没有<code>records</code>的时候，如何将这些JSON数据指定一个默认值？</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded">sqlalchemy<span class="token punctuation">.</span>exc<span class="token punctuation">.</span>StatementError<span class="token punctuation">:</span> <span class="token punctuation">(</span>builtins<span class="token punctuation">.</span>TypeError<span class="token punctuation">)</span> SQLite DateTime <span class="token builtin">type</span> only accepts Python datetime <span class="token keyword">and</span> date objects <span class="token keyword">as</span> <span class="token builtin">input</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>SQL<span class="token punctuation">:</span> INSERT INTO projects <span class="token punctuation">(</span>name<span class="token punctuation">,</span> status<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> all_time<span class="token punctuation">,</span> daily_time<span class="token punctuation">,</span> weekly_time<span class="token punctuation">,</span> monthly_time<span class="token punctuation">,</span> yearly_time<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span>?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">,</span> ?<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>parameters<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'In Planning'</span><span class="token punctuation">,</span> <span class="token string">'user_id'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code><button class="copy-code-button">复制</button></pre></div><div><pre><code>  
  

@bp.route('/project/&lt;int:id&gt;/delete', methods=['DELETE'])

def delete(id):

&nbsp; project = Project.query.get(id)

&nbsp; db.session.delete(project)

&nbsp; db.session.commit()

&nbsp; return jsonify(status='success')

  

@bp.route('/project/&lt;int:id&gt;/edit', methods=['GET','POST'])

def edit(id):

&nbsp; project = Project.query.get(id)

&nbsp; if request.method == 'POST':

&nbsp; &nbsp; project.name = request.form['name']

&nbsp; &nbsp; project.status = request.form['status']

&nbsp; &nbsp; db.session.commit()

&nbsp; &nbsp; return redirect(url_for('main.all'))

&nbsp; return render_template('edit.html', project=project)

  

@bp.route('/project/&lt;int:id&gt;/start', methods=['POST'])

def start(id):

&nbsp; project = Project.query.get(id)

&nbsp; record = Record(project_id=project.id)

&nbsp; db.session.add(record)

&nbsp; db.session.commit()

&nbsp; return jsonify(status='success')

  

@bp.route('/project/&lt;int:id&gt;/stop', methods=['PUT'])

def stop(id):

&nbsp; record = Record.query.filter_by(project_id=id).order_by(Record.start_time.desc()).first()

&nbsp; record.end_time = datetime.now()

&nbsp; db.session.commit()

&nbsp; return jsonify(status='success')

  

@bp.route('/project/&lt;int:id&gt;/delete_record', methods=['DELETE'])

def delete_record(id):

&nbsp; record = Record.query.get(id)

&nbsp; db.session.delete(record)

&nbsp; db.session.commit()

&nbsp; return jsonify(status='success')

  

@bp.route('/project/&lt;int:id&gt;/update_record', methods=['PUT'])

def update_record(id):

&nbsp; record = Record.query.get(id)

&nbsp; record.start_time = datetime.strptime(request.form['start_time'],'%Y-%m-%d %H:%M:%S')

&nbsp; record.end_time = datetime.strptime(request.form['end_time'],'%Y-%m-%d %H:%M:%S')

&nbsp; record.duration = record.end_time - record.start_time

&nbsp; db.session.commit()

&nbsp; return jsonify(status='success')

  

@bp.route('/project/&lt;int:id&gt;/records')

def get_records(id):

&nbsp; records = Record.query.filter_by(project_id=id).order_by(Record.start_time.desc()).all()

&nbsp; return jsonify(records=[record.serialize() for record in records])

  

@bp.route('/project/&lt;int:id&gt;/records/&lt;int:page&gt;')

def get_records_by_page(id,page):

&nbsp; records = Record.query.filter_by(project_id=id).order_by(Record.start_time.desc()).paginate(page=page, per_page=10)

&nbsp; return jsonify(records=[record.serialize() for record in records.items])

  

@bp.route('/project/&lt;int:id&gt;/records/&lt;int:page&gt;/&lt;int:per_page&gt;')

def get_records_by_page_and_per_page(id,page,per_page):

&nbsp; records = Record.query.filter_by(project_id=id).order_by(Record.start_time.desc()).paginate(page=page, per_page=per_page)

&nbsp; return jsonify(records=[record.serialize() for record in records.items])

  

@bp.route('/project/&lt;int:id&gt;/records/&lt;string:start_time&gt;/&lt;string:end_time&gt;')

def get_records_by_time(id,start_time,end_time):

&nbsp; records = Record.query.filter_by(project_id=id).filter(Record.start_time.between(start_time,end_time)).order_by(Record.start_time.desc()).all()

&nbsp; return jsonify(records=[record.serialize() for record in records])

  

@bp.route('/project/&lt;int:id&gt;/records/&lt;string:start_time&gt;/&lt;string:end_time&gt;/&lt;int:page&gt;')

def get_records_by_time_and_page(id,start_time,end_time,page):

&nbsp; records = Record.query.filter_by(project_id=id).filter(Record.start_time.between(start_time,end_time)).order_by(Record.start_time.desc()).paginate(page=page, per_page=10)

&nbsp; return jsonify(records=[record.serialize() for record in records.items])

  

@bp.route('/project/&lt;int:id&gt;/records/&lt;string:start_time&gt;/&lt;string:end_time&gt;/&lt;int:page&gt;/&lt;int:per_page&gt;')

def get_records_by_time_and_page_and_per_page(id,start_time,end_time,page,per_page):

&nbsp; records = Record.query.filter_by(project_id=id).filter(Record.start_time.between(start_time,end_time)).order_by(Record.start_time.desc()).paginate(page=page, per_page=per_page)

&nbsp; return jsonify(records=[record.serialize() for record in records.items])

  

# 项目详情

@bp.route('/project/&lt;int:id&gt;')

def project(id):

&nbsp; project = Project.query.get(id)

&nbsp; return render_template('views/project.html', project=project)

  

# 项目详情

@bp.route('/project/&lt;int:id&gt;/status', methods=['GET'])

def get_project_status(id):

&nbsp; project = Project.query.get(id)

&nbsp; return jsonify(status=project.status)
</code><button class="copy-code-button">复制</button></pre></div><div><pre class="language-html" tabindex="0"><code class="language-html is-loaded"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    {% for project in projects %}

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--添加一个排序的序号--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>actions<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">toggleStatus</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">{</span>project<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!--`开始计时`/`停止计时`按钮，默认为`开始计时`,状态为`暂停`，按下按钮后状态切换为`进行中`，同时按钮文本切换为`停止计时`，记录下此时的DateTime作为本次`Record`的`start_time`，再次点击按钮（此时钮文本为`停止计时`），状态从`进行中`切换为`暂停`，按钮文本切换回`开始计时`，记录下此时的DateTime作为本次`Record`的`end_time`，完成一次`Record`,存入数据库中，计算duration=end_time=start_time. 在all_time上+=本次record的duration，在daily_time查询当天日期对应的JSON{date：YYYY-MM-DD,time:HH:MM:SS}，并使得time的值+=duration。若未查询到，则新建一个JSON数据，time默认初始化为0后+=duration。数据实时更新到all.html上，weekly，monthly，yearly以此类推。--&gt;</span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>details<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ project.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>details<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ project.status }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>details<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{ project.total_time }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>more<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>more<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!--more按钮，点击可选择delete，rename等按钮--&gt;</span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

    {% endfor %}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code><button class="copy-code-button">复制</button></pre></div><div><pre class="language-js" tabindex="0"><code class="language-js is-loaded"><span class="token known-class-name class-name">Array</span><span class="token punctuation">.</span><span class="token keyword module">from</span><span class="token punctuation">(</span>timerBtns<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">btn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  btn<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> projectId <span class="token operator">=</span> btn<span class="token punctuation">.</span><span class="token property-access">dataset</span><span class="token punctuation">.</span><span class="token property-access">projectId</span><span class="token punctuation">;</span>

    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>projectId<span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>btn<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">contains</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Stop timer</span>

        btn<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        btn<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'Record'</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> endTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> record <span class="token operator">=</span> <span class="token punctuation">{</span>

          project_id<span class="token operator">:</span> projectId<span class="token punctuation">,</span>

          start_time<span class="token operator">:</span> <span class="token function">formatDateTime</span><span class="token punctuation">(</span>startTime<span class="token punctuation">)</span><span class="token punctuation">,</span>

          end_time<span class="token operator">:</span> <span class="token function">formatDateTime</span><span class="token punctuation">(</span>endTime<span class="token punctuation">)</span>

        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token function">createRecord</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>

        startTime <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>

      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>

        <span class="token comment">// Start timer</span>

        startTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        btn<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        btn<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'Stop'</span><span class="token punctuation">;</span>

      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">复制</button></pre></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder"><div class="graph-view-container"><div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div><canvas id="graph-canvas" width="512px" height="512px"></canvas></div></div></div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#C++课程设计：3.2-所有项目"><span class="tree-item-title"><p>C++课程设计：3.2-所有项目</p></span></a></div><div class="tree-item-children"><div class="tree-item" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#需求"><span class="tree-item-title"><p>需求</p></span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div></body></html>